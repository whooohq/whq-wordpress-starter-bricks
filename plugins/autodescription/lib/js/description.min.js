'use strict';window.tsfDescription=function(){const a=new Map,b={},c=b=>a.get(b),d=(a,c)=>c?b[a]?.[c]:b[a],e=(a,c,d)=>{if(b[a][c]!==d)switch(b[a][c]=d,c){case"allowReferenceChange":case"defaultDescription":case"useDefaultDescription":default:p(a);}},f=a=>{let b=[document.getElementById(`tsf-description-reference_${a}`)];if(d(a,"hasLegacy")){let a=document.getElementById("tsf-description-reference");a&&b.unshift(a)}return b},g=a=>{const b=f(a.target.id);if(!b[0])return;const c=d(a.target.id,"allowReferenceChange"),e=!c||d(a.target.id,"useDefaultDescription");let g=c&&a.target.value.trim()||e&&d(a.target.id,"defaultDescription")||"";const h=tsf.escapeString(tsf.decodeEntities(tsf.sDoubleSpace(tsf.sTabs(tsf.sSingleLine(g).trim())))),i=new Event("change");b.forEach(a=>{a.innerHTML=h,setTimeout(()=>{a.dispatchEvent(i)},0)})},h=a=>{a.target.placeholder=f(a.target.id)[0].textContent},i=a=>{const b=document.getElementById(`${a.target.id}_chars`),c=f(a.target.id)[0];b&&tsfC?.updateCharacterCounter({e:b,text:c.innerHTML,field:"description",type:"search"})},j=a=>{const b=document.getElementById(`${a.target.id}_pixels`),c=f(a.target.id)[0];b&&tsfC?.updatePixelCounter({e:b,text:c.innerHTML,field:"description",type:"search"})},k=b=>{b?c(b)?.dispatchEvent(new Event("input")):a.forEach(a=>a.id&&k(a.id))},l=b=>{b?c(b)?.dispatchEvent(new CustomEvent("tsf-update-description-counter")):a.forEach(a=>a.id&&l(a.id))},m=a=>{g(a),h(a),n(a)},n=a=>{i(a),j(a)};let o={};const p=a=>{a in o&&clearTimeout(o[a]),o[a]=setTimeout(()=>k(a),1e3/60)},q=a=>{if("tsfAys"in window){let b=tsfAys.areSettingsChanged();k(a),!b&&tsfAys.areSettingsChanged()&&tsfAys.reset()}else k(a)};let r={};const s=a=>{a in r&&clearTimeout(r[a]),r[a]=setTimeout(()=>q(a),1e3/60)};let t=window.innerWidth;const u=()=>{const a=window.innerWidth;t<a?782>=t&&782<=a&&q():782<=t&&782>=a&&q(),t=a},v=a=>{!a instanceof Element||(a.addEventListener("input",m),a.addEventListener("tsf-update-description-counter",n),s(a.id))},w=()=>{window.addEventListener("tsf-resize",u),window.addEventListener("tsf-counter-updated",()=>s())};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",w)}},{setInputElement:d=>(a.set(d.id,d),b[d.id]={allowReferenceChange:!0,defaultDescription:"",useDefaultDescription:!0},v(d),c(d.id)),getInputElement:c,getStateOf:d,updateStateOf:e,updateStateAll:(b,c,d)=>{d=Array.isArray(d)?d:[d],a.forEach(a=>{d.includes(a.id)||e(a.id,b,c)})},triggerCounter:l,triggerInput:k,enqueueTriggerInput:p,triggerUnregisteredInput:q,enqueueUnregisteredInputTrigger:s})}(),window.tsfDescription.load();
