'use strict';window.tsfPTGB=function(){const a="undefined"!=typeof tsfPTL10n&&tsfPTL10n,b=a.taxonomies,{createElement:c,Fragment:d,Component:e,useState:f,useEffect:g}=wp.element,{SelectControl:h}=wp.components,{useSelect:i}=wp.data,{unescape:j}=lodash,k=[],l={per_page:-1,orderby:"id",order:"asc",_fields:"id,name"},m=(a,c)=>b[a]?.i18n[c]||"";let n={};const o=a=>{const c=()=>document.getElementById(`autodescription[_primary_term_${a}]`),d=()=>+c().value,e=a=>+(c().value=+a);return{get:d,set:e,revalidate:a=>{const b=d();return a.includes(b)?b:e(a?.[0]||0)},register:()=>{const c=document.getElementById("tsf-gutenberg-data-holder");return c?(c.insertAdjacentHTML("beforeend",wp.template("tsf-primary-term-selector")({taxonomy:b[a]})),n[a]=!0):n[a]=!1},isRegistered:()=>n[a]||!1}},p=()=>{function a({taxonomySlug:a,_legacySelectedTerms:b}){const d=o(a),[e,n]=f(d.get()),[p,q]=f(!1),[r,s]=f(!1),{selectedTerms:t,loading:u,availableTerms:v,_taxonomy:w}=i(b=>{const{getTaxonomy:c,getEntityRecords:d,isResolving:e}=b("core"),{getEditedPostAttribute:f}=b("core/editor"),g=c(a),h=["taxonomy",a,l];return{selectedTerms:f(g?.rest_base)||k,loading:r||e("getEntityRecords",h),availableTerms:p||d(...h)||k,_taxonomy:g}},[a,r,p]);if(g(()=>{t.includes(+e)&&d.get()===+e||(d.revalidate(t),n(d.get()))},[t]),g(()=>(w?.rest_base&&b?.length&&!r&&(!p?.length||b.filter(a=>!v.map(a=>a.id).includes(a)).length)&&(s(!0),wp.apiFetch({path:wp.url?.addQueryArgs(`/wp/v2/${w.rest_base}`,l)}).then(a=>{q(a)}).finally(()=>{s(!1)})),()=>{s(!1)}),[b]),2>t?.length)return d.set(0),null;const x=a=>{t.includes(+a)&&(d.set(a),n(d.get()),"tsfAys"in window&&tsfAys.registerChange())};return c(h,{label:m(a,"selectPrimary"),value:e,className:"tsf-pt-gb-selector",onChange:x,options:(()=>v.map(a=>t.includes(a?.id)&&{value:a.id,label:j(a?.name)}).filter(Boolean)||"")(),disabled:(()=>!(t.length&&v.length&&!u))()})}if(Object.keys(b).length){for(let a in b)o(a).register();wp.hooks.addFilter("editor.PostTaxonomyType","tsf/pt",b=>class extends e{render(){return o(this.props?.slug).isRegistered()?c(d,null,c(b,{...this.props}),c(a,{taxonomySlug:this.props?.slug,_legacySelectedTerms:this.props?.terms})):c(b,{...this.props})}})}};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",p)}},{l10n:a})}(),window.tsfPTGB.load();
