{"version":3,"sources":["webpack://gravityformsrecaptcha/./js/src/plugin_settings.js"],"names":["$","recaptchaV2Settings","v2Settings","init","cacheElements","addEventListeners","container","fields","siteKey","secretKey","reset","type","on","window","loadRecaptcha","self","recaptcha","save","flushExistingState","remove","canBeDisplayed","hideRecaptcha","prop","showSelectedRecaptcha","render","typeValue","grecaptcha","sitekey","val","trim","size","badge","callback","___grecaptcha_cfg","clients","count","html","hide","show","Error","execute","recaptchaV3Settings","v3Settings","token","strings","gforms_recaptcha_recaptcha_strings","validateKeysV3","threshold","disableBadge","keysStatus","cache","site_key","length","clearValidationFeedback","unsetValid","closest","getRecaptchaToken","Promise","resolve","reject","siteKeyContainer","siteKeyValue","find","ready","action","then","error","secretKeyContainer","keysStatusInput","catch","setInvalid","finally","ajax","method","dataType","url","ajaxurl","data","nonce","site_key_v3","secret_key_v3","response","keys_status","setValid","el","removeClass","addClass","document","gform","adminUtils","handleUnsavedChanges","jQuery"],"mappings":"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","file":"./js/plugin_settings.js","sourcesContent":["/* global jQuery, gform, grecaptcha, gforms_recaptcha_recaptcha_strings */\n\n( ( $ ) => {\n\t/**\n\t * Handles reCAPTCHA v2 plugin settings validation.\n\t *\n\t * @since 1.0\n\t *\n\t * @return {void}\n\t */\n\tconst recaptchaV2Settings = () => {\n\t\tconst v2Settings = {};\n\n\t\t/**\n\t\t * Initialize reCAPTCHA v2 settings.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv2Settings.init = () => {\n\t\t\tv2Settings.cacheElements();\n\t\t\tv2Settings.addEventListeners();\n\t\t};\n\n\t\t/**\n\t\t * Cache the fields used by this handler.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv2Settings.cacheElements = () => {\n\t\t\tv2Settings.container = $( 'div[id=\"gform_setting_reset_v2\"]' );\n\t\t\tv2Settings.fields = {\n\t\t\t\tsiteKey: $( 'input[name=\"_gform_setting_site_key_v2\"]' ),\n\t\t\t\tsecretKey: $( 'input[name=\"_gform_setting_secret_key_v2\"]' ),\n\t\t\t\treset: $( 'input[name=\"_gform_setting_reset_v2\"]' ),\n\t\t\t\ttype: $( 'input[name=\"_gform_setting_type_v2\"]' ),\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t\t * Add event listeners for this handler.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv2Settings.addEventListeners = () => {\n\t\t\tv2Settings.fields.siteKey.on( 'change', window.loadRecaptcha );\n\t\t\tv2Settings.fields.secretKey.on( 'change', window.loadRecaptcha );\n\t\t\tv2Settings.fields.type.on( 'change', () => window.loadRecaptcha() );\n\t\t};\n\n\t\t/**\n\t\t * Handles showing and hiding the reCAPTCHA itself.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\twindow.loadRecaptcha = () => {\n\t\t\tconst self = {};\n\n\t\t\t/**\n\t\t\t * Initialize the reCAPTCHA rendering process.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.init = () => {\n\t\t\t\tv2Settings.recaptcha = $( '#recaptcha' );\n\t\t\t\tv2Settings.save = $( '#gform-settings-save' );\n\t\t\t\tself.flushExistingState();\n\n\t\t\t\t// Reset key status.\n\t\t\t\t// Note: recaptcha is misspelled here for legacy reasons.\n\t\t\t\t$( '#recpatcha .gform-settings-field__feedback' ).remove();\n\n\t\t\t\t// If no public or private key is provided, exit.\n\t\t\t\tif ( ! self.canBeDisplayed() ) {\n\t\t\t\t\tself.hideRecaptcha();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tv2Settings.save.prop( 'disabled', true );\n\n\t\t\t\tself.showSelectedRecaptcha();\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Renders the v2 reCAPTCHA.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @param {string} typeValue The selected type to render.\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.render = ( typeValue ) => {\n\t\t\t\t// Render reCAPTCHA.\n\t\t\t\tgrecaptcha.render(\n\t\t\t\t\t'recaptcha',\n\t\t\t\t\t{\n\t\t\t\t\t\tsitekey: v2Settings.fields.siteKey.val().trim(),\n\t\t\t\t\t\tsize: typeValue === 'invisible' ? typeValue : '',\n\t\t\t\t\t\tbadge: 'inline',\n\t\t\t\t\t\t'error-callback': () => {},\n\t\t\t\t\t\tcallback: () => v2Settings.save.prop( 'disabled', false ),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Flush the existing state of the reCAPTCHA handler.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.flushExistingState = () => {\n\t\t\t\twindow.___grecaptcha_cfg.clients = {};\n\t\t\t\twindow.___grecaptcha_cfg.count = 0;\n\t\t\t\tv2Settings.recaptcha.html( '' );\n\t\t\t\tv2Settings.fields.reset.val( '1' );\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Determines whether the reCAPTCHA can be shown.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {boolean} Whether the reCAPTCHA can be shown.\n\t\t\t */\n\t\t\tself.canBeDisplayed = () => {\n\t\t\t\treturn v2Settings.fields.siteKey.val() && v2Settings.fields.secretKey.val();\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Hides the reCAPTCHA element.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.hideRecaptcha = () => {\n\t\t\t\tv2Settings.save.prop( 'disabled', false );\n\t\t\t\tv2Settings.container.hide();\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Show the selected reCAPTCHA type.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.showSelectedRecaptcha = () => {\n\t\t\t\tconst typeValue = $( 'input[name=\"_gform_setting_type_v2\"]:checked' ).val();\n\n\t\t\t\tself.render( typeValue );\n\n\t\t\t\tswitch ( typeValue ) {\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\t$( '#gforms_checkbox_recaptcha_message, label[for=\"reset\"]' ).show();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'invisible':\n\t\t\t\t\t\t$( '#gforms_checkbox_recaptcha_message, label[for=\"reset\"]' ).hide();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error( 'Unexpected type selected.' );\n\t\t\t\t}\n\n\t\t\t\tv2Settings.container.show();\n\n\t\t\t\tif ( typeValue === 'invisible' ) {\n\t\t\t\t\tgrecaptcha.execute();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tself.init();\n\t\t};\n\n\t\tv2Settings.init();\n\t};\n\n\t/**\n\t * Handles reCAPTCHA v3 plugin settings validation.\n\t *\n\t * @since 1.0\n\t *\n\t * @return {void}\n\t */\n\tconst recaptchaV3Settings = () => {\n\t\tconst v3Settings = {};\n\n\t\t/**\n\t\t * Initializes the reCAPTCHA v3 settings handler.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.init = () => {\n\t\t\tv3Settings.token = '';\n\t\t\tv3Settings.strings = gforms_recaptcha_recaptcha_strings;\n\n\t\t\tv3Settings.cacheElements();\n\t\t\tv3Settings.validateKeysV3();\n\t\t\tv3Settings.addEventListeners();\n\t\t};\n\n\t\t/**\n\t\t * Cache HTML elements for the v3 reCAPTCHA settings.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.cacheElements = () => {\n\t\t\tv3Settings.fields = {\n\t\t\t\tsiteKey: '#site_key_v3',\n\t\t\t\tsecretKey: '#secret_key_v3',\n\t\t\t\tthreshold: '#score_threshold_v3',\n\t\t\t\tdisableBadge: '#disable_badge_v3',\n\t\t\t\tkeysStatus: '#gform_setting_recaptcha_keys_status_v3',\n\t\t\t};\n\n\t\t\tv3Settings.cache = {\n\t\t\t\tsiteKey: $( v3Settings.fields.siteKey ),\n\t\t\t\tsecretKey: $( v3Settings.fields.secretKey ),\n\t\t\t\tkeysStatus: $( v3Settings.fields.keysStatus ),\n\t\t\t\tsave: $( '#gform-settings-save' ),\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t\t * Setup event listeners for field validation.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.addEventListeners = () => {\n\t\t\tif ( ! v3Settings.strings.site_key.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$( v3Settings.fields.siteKey ).on( 'keyup', () => v3Settings.clearValidationFeedback() );\n\t\t\t$( v3Settings.fields.secretKey ).on( 'keyup', () => v3Settings.clearValidationFeedback() );\n\t\t};\n\n\t\t/**\n\t\t * Empty out the validation feedback if the fields are modified, as we can't yet know the status.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.clearValidationFeedback = () => {\n\t\t\tv3Settings.unsetValid( v3Settings.cache.siteKey.closest( '.gform-settings-input__container' ) );\n\t\t\tv3Settings.unsetValid( v3Settings.cache.secretKey.closest( '.gform-settings-input__container' ) );\n\t\t};\n\n\t\t/**\n\t\t * Handles validation of the v3 site key.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {Promise<unknown>} Returns a promise so this can be verified synchronously if checking the secret key.\n\t\t */\n\t\tv3Settings.getRecaptchaToken = () => {\n\t\t\treturn new Promise( ( resolve, reject ) => {\n\t\t\t\tconst siteKeyContainer = v3Settings.cache.siteKey.closest( '.gform-settings-input__container' );\n\n\t\t\t\ttry {\n\t\t\t\t\tconst { siteKey } = v3Settings.cache;\n\t\t\t\t\tconst siteKeyValue = siteKey.val().trim();\n\n\t\t\t\t\tif ( 0 === siteKeyValue.length ) {\n\t\t\t\t\t\tv3Settings.unsetValid( siteKeyContainer );\n\t\t\t\t\t\tv3Settings.unsetValid( v3Settings.cache.keysStatus.closest( '.gform-settings-input__container' ) );\n\t\t\t\t\t\t$( v3Settings.fields.keysStatus ).find( 'input' ).val( '0' );\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tgrecaptcha.ready( () => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tgrecaptcha.execute( siteKeyValue, { action: 'submit' } ).then( ( token ) => {\n\t\t\t\t\t\t\t\tresolve( token );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} catch ( error ) {\n\t\t\t\t\t\t\treject( error );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} catch ( error ) {\n\t\t\t\t\treject( error );\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\n\t\t/**\n\t\t * Handles validation of the v3 site and secret keys.\n\t\t *\n\t\t * On page load, attempt to generate a reCAPTCHA token and immediately validate it on the server. If it's good,\n\t\t * we'll update the presentation of the keys to indicate success or failure.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.validateKeysV3 = () => {\n\t\t\tconst siteKeyContainer = v3Settings.cache.siteKey.closest( '.gform-settings-input__container' );\n\t\t\tconst secretKeyContainer = v3Settings.cache.secretKey.closest( '.gform-settings-input__container' );\n\t\t\tconst keysStatusInput = $( v3Settings.fields.keysStatus ).find( 'input' );\n\n\t\t\tif ( ! $( v3Settings.fields.siteKey ).val().trim().length ) {\n\t\t\t\tv3Settings.unsetValid( siteKeyContainer );\n\t\t\t\tv3Settings.unsetValid( secretKeyContainer );\n\t\t\t\tkeysStatusInput.val( '0' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tv3Settings.getRecaptchaToken()\n\t\t\t\t.then( ( token ) => {\n\t\t\t\t\tv3Settings.token = token;\n\t\t\t\t} )\n\t\t\t\t.catch( () => {\n\t\t\t\t\tv3Settings.setInvalid( siteKeyContainer );\n\t\t\t\t\tv3Settings.setInvalid( secretKeyContainer );\n\t\t\t\t\tkeysStatusInput.val( '0' );\n\t\t\t\t} )\n\t\t\t\t.finally( () => {\n\t\t\t\t\t$.ajax(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\tdataType: 'JSON',\n\t\t\t\t\t\t\turl: v3Settings.strings.ajaxurl,\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\taction: 'verify_secret_key',\n\t\t\t\t\t\t\t\tnonce: v3Settings.strings.nonce,\n\t\t\t\t\t\t\t\ttoken: v3Settings.token,\n\t\t\t\t\t\t\t\tsite_key_v3: $( v3Settings.fields.siteKey ).val(),\n\t\t\t\t\t\t\t\tsecret_key_v3: $( v3Settings.fields.secretKey ).val(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t).then( ( response ) => {\n\t\t\t\t\t\tswitch ( response.data.keys_status ) {\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\t\tv3Settings.setValid( siteKeyContainer );\n\t\t\t\t\t\t\t\tv3Settings.setValid( secretKeyContainer );\n\t\t\t\t\t\t\t\tkeysStatusInput.val( '1' );\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\t\tv3Settings.setInvalid( siteKeyContainer );\n\t\t\t\t\t\t\t\tv3Settings.setInvalid( secretKeyContainer );\n\t\t\t\t\t\t\t\tkeysStatusInput.val( '0' );\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tv3Settings.unsetValid( siteKeyContainer );\n\t\t\t\t\t\t\t\tv3Settings.unsetValid( secretKeyContainer );\n\t\t\t\t\t\t\t\tkeysStatusInput.val( '0' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t};\n\n\t\t/**\n\t\t * Updates the text field to display no feedback.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @param {Object} el The jQuery element.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.unsetValid = ( el ) => {\n\t\t\tel.removeClass( 'gform-settings-input__container--feedback-success' );\n\t\t\tel.removeClass( 'gform-settings-input__container--feedback-error' );\n\t\t};\n\n\t\t/**\n\t\t * Updates the text field to display the successful feedback.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @param {Object} el The jQuery element.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.setValid = ( el ) => {\n\t\t\tel.addClass( 'gform-settings-input__container--feedback-success' );\n\t\t\tel.removeClass( 'gform-settings-input__container--feedback-error' );\n\t\t};\n\n\t\t/**\n\t\t * Updates the text field to display the error feedback.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @param {Object} el The jQuery element.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.setInvalid = ( el ) => {\n\t\t\tel.removeClass( 'gform-settings-input__container--feedback-success' );\n\t\t\tel.addClass( 'gform-settings-input__container--feedback-error' );\n\t\t};\n\n\t\tv3Settings.init();\n\t};\n\n\t$( document ).ready( () => {\n\t\trecaptchaV3Settings();\n\t\trecaptchaV2Settings();\n\t\tgform.adminUtils.handleUnsavedChanges( '#gform-settings' );\n\t} );\n} )( jQuery );\n"],"sourceRoot":""}