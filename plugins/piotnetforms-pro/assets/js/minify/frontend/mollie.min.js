jQuery(document).ready((function(e){var t=new URLSearchParams(window.location.search);if("mollie_payment"===t.get("piotnetforms_action")){t.delete("piotnetforms_action");var i=window.location.href.replace(window.location.search,"?"+t.toString());i=new URL(i),new URLSearchParams(i.search).toString()?window.history.pushState({},"",i.href):window.history.pushState({},"",i.href.replace("?",""));var o,s,a=localStorage.getItem("piotnetforms_data_form_mollie_payment"),n=(a=JSON.parse(a)).formName,r=e('[data-piotnetforms-mollie-payment="'+n+'"]'),m=r.closest(".piotnetforms-submit"),d=r.closest(".piotnetforms__form");if(a){var f=JSON.parse(a.fields);e.each(f,(function(t,i){i.value&&("radio"==i.type?e('[data-piotnetforms-id="'+n+'"][name="form_fields['+i.name+']"][value="'+i.value+'"]').prop("checked",!0):"checkbox"==i.type?(s=i.value.split(","),e.each(s,(function(t,o){e('[data-piotnetforms-id="'+n+'"][name="form_fields['+i.name+'][]"][value="'+o+'"]').prop("checked",!0)}))):e('[data-piotnetforms-id="'+n+'"][name="form_fields['+i.name+']"]').val(i.value))}))}e(document).find('[data-piotnetforms-id="'+n+'"]').closest(".piotnetforms-fields-wrapper").addClass("piotnetforms-waiting"),r.closest(".piotnetforms-submit").addClass("piotnetforms-waiting"),e.ajax({type:"post",dataType:"json",url:e("[data-piotnetforms-ajax-url]").data("piotnetforms-ajax-url"),data:{action:"piotnetforms_mollie_get_payment",payment_id:a.mollie_payment_id},success:function(e){e.status&&(o="paid"==e.status?"succeeded":"pending"==e.status?"pending":"failed")},error:function(e){}}),e.ajax({url:e("[data-piotnetforms-ajax-url]").data("piotnetforms-ajax-url"),type:"POST",data:a,success:function(t){if(m.removeClass("piotnetforms-waiting"),e(document).find('[data-piotnetforms-id="'+n+'"]').closest(".piotnetforms-fields-wrapper").removeClass("piotnetforms-waiting"),t){var i=JSON.parse(t);i.payment_status=o,m.find(".piotnetforms-message").each((function(){if(""!=i.post_url){var e=r.html().replace("[post_url]",'<a href="'+i.post_url+'">'+i.post_url+"</a>");r.html(e)}})),i.custom_message&&d.find("[data-piotnetforms-message]").html(i.custom_message),"succeeded"!=i.payment_status&&"active"!=i.payment_status||m.find(".piotnetforms-alert--mollie .piotnetforms-message-success").addClass("visible"),"pending"==i.payment_status&&m.find(".piotnetforms-alert--mollie .piotnetforms-help-inline").addClass("visible"),"failed"!=i.payment_status&&"incomplete"!=i.payment_status||(m.find(".piotnetforms-alert--mollie .piotnetforms-message-danger").addClass("visible"),e(document).find('[data-piotnetforms-id="'+n+'"]').closest(".piotnetforms-fields-wrapper").removeClass("piotnetforms-waiting"),r.closest(".piotnetforms-fields-wrapper").removeClass("piotnetforms-waiting")),""!=i.status?(d.find(".piotnetforms-alert--mail .piotnetforms-message-success").addClass("visible"),m.find("[data-piotnetforms-trigger-success]").trigger("click")):i.register_message.error?(m.closest("#piotnetforms").find('[name="form_fields['+i.register_message.field_existing+']"]')[0].setCustomValidity(i.register_message.error),m.closest("#piotnetforms").find('[name="form_fields['+i.register_message.field_existing+']"]')[0].reportValidity(),m.closest("#piotnetforms").find('[name="form_fields['+i.register_message.field_existing+']"]').on("keyup",(function(){m.closest("#piotnetforms").find('[name="form_fields['+i.register_message.field_existing+']"]')[0].setCustomValidity("")}))):(d.find(".piotnetforms-alert--mail .piotnetforms-message-danger").addClass("visible"),e(document).find('[data-piotnetforms-id="'+n+'"]').closest(".piotnetforms-fields-wrapper").removeClass("piotnetforms-waiting"),r.closest(".piotnetforms-fields-wrapper").removeClass("piotnetforms-waiting"),m.find("[data-piotnetforms-trigger-failed]").trigger("click"))}if(0!=m.find('input[name="redirect"]').length){var s=m.find('input[name="redirect"]').val().trim(),a=m.find('input[name="redirect"]').attr("data-piotnetforms-open-new-tab");-1!==t.indexOf(",")&&"1"!=i.failed_status&&(""!=i.post_url&&"[post_url]"==s?window.location.href=i.post_url:""!=i.redirect&&("yes"==a?window.open(i.redirect,"_blank"):window.location.href=i.redirect))}0!=e(document).find('[data-piotnetforms-popup][data-piotnetforms-hidden-form-id="'+n+'"]').length&&e(document).find('[data-piotnetforms-popup][data-piotnetforms-hidden-form-id="'+n+'"]').trigger("click"),0!=e(document).find('[data-piotnetforms-popup-open][data-piotnetforms-hidden-form-id="'+n+'"]').length&&e(document).find('[data-piotnetforms-popup-open][data-piotnetforms-hidden-form-id="'+n+'"]').trigger("click"),0!=e(document).find('[data-piotnetforms-popup-close][data-piotnetforms-hidden-form-id="'+n+'"]').length&&e(document).find('[data-piotnetforms-popup-close][data-piotnetforms-hidden-form-id="'+n+'"]').trigger("click")}}),localStorage.removeItem("piotnetforms_data_form_mollie_payment")}}));