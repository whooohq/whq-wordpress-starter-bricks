"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();(function(){var e,t,i,s,l=[].indexOf;jQuery.fn.extend({imagepicker:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.each((function(){var i;if((i=jQuery(this)).data("picker")&&i.data("picker").destroy(),i.data("picker",new e(this,s(t))),null!=t.initialized)return t.initialized.call(i.data("picker"))}))}}),s=function(e){var t;return t={hide_select:!0,show_label:!1,initialized:void 0,changed:void 0,clicked:void 0,selected:void 0,limit:void 0,limit_reached:void 0,font_awesome:!1},jQuery.extend(t,e)},i=function(e,t){var i,s,l,a;if(!e||!t||e.length!==t.length)return!1;for(e=e.slice(0),t=t.slice(0),e.sort(),t.sort(),i=s=0,l=e.length;s<l;i=++s)if(a=e[i],t[i]!==a)return!1;return!0},e=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.sync_picker_with_select=this.sync_picker_with_select.bind(this),this.opts=i,this.select=jQuery(t),this.multiple="multiple"===this.select.attr("multiple"),null!=this.select.data("limit")&&(this.opts.limit=parseInt(this.select.data("limit"))),this.build_and_append_picker()}return _createClass(e,[{key:"destroy",value:function(){var e,t,i;for(e=0,t=(i=this.picker_options).length;e<t;e++)i[e].destroy();return this.picker.remove(),this.select.off("change",this.sync_picker_with_select),this.select.removeData("picker"),this.select.show()}},{key:"build_and_append_picker",value:function(){return this.opts.hide_select&&this.select.hide(),this.select.on("change",this.sync_picker_with_select),null!=this.picker&&this.picker.remove(),this.create_picker(),this.select.after(this.picker),this.sync_picker_with_select()}},{key:"sync_picker_with_select",value:function(){var e,t,i,s,l;for(l=[],e=0,t=(s=this.picker_options).length;e<t;e++)(i=s[e]).is_selected()?l.push(i.mark_as_selected()):l.push(i.unmark_as_selected());return l}},{key:"create_picker",value:function(){return this.picker=jQuery("<ul class='thumbnails image_picker_selector'></ul>"),this.picker_options=[],this.recursively_parse_option_groups(this.select,this.picker),this.picker}},{key:"recursively_parse_option_groups",value:function(e,i){var s,l,a,n,r,c,o,u,h,d;for(l=0,n=(u=e.children("optgroup")).length;l<n;l++)o=u[l],o=jQuery(o),(s=jQuery("<ul></ul>")).append(jQuery("<li class='group_title'>"+o.attr("label")+"</li>")),i.append(jQuery("<li class='group'>").append(s)),this.recursively_parse_option_groups(o,s);for(h=function(){var i,s,l,a;for(a=[],i=0,s=(l=e.children("option")).length;i<s;i++)c=l[i],a.push(new t(c,this,this.opts));return a}.call(this),d=[],a=0,r=h.length;a<r;a++)c=h[a],this.picker_options.push(c),c.has_image()&&d.push(i.append(c.node));return d}},{key:"has_implicit_blanks",value:function(){var e;return function(){var t,i,s,l;for(l=[],t=0,i=(s=this.picker_options).length;t<i;t++)(e=s[t]).is_blank()&&!e.has_image()&&l.push(e);return l}.call(this).length>0}},{key:"selected_values",value:function(){return this.multiple?this.select.val()||[]:[this.select.val()]}},{key:"toggle",value:function(e,t){var s,a,n;if(a=this.selected_values(),n=e.value().toString(),this.multiple?l.call(this.selected_values(),n)>=0?((s=this.selected_values()).splice(jQuery.inArray(n,a),1),this.select.val([]),this.select.val(s)):null!=this.opts.limit&&this.selected_values().length>=this.opts.limit?null!=this.opts.limit_reached&&this.opts.limit_reached.call(this.select):this.select.val(this.selected_values().concat(n)):this.has_implicit_blanks()&&e.is_selected()?this.select.val(""):this.select.val(n),!i(a,this.selected_values())&&(this.select.change(),null!=this.opts.changed))return this.opts.changed.call(this.select,a,this.selected_values(),t)}}]),e}(),t=function(){function e(t,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.clicked=this.clicked.bind(this),this.picker=i,this.opts=s,this.option=jQuery(t),this.create_node()}return _createClass(e,[{key:"destroy",value:function(){return this.node.find(".thumbnail").off("click",this.clicked)}},{key:"has_image",value:function(){return null!=this.option.data("img-src")}},{key:"is_blank",value:function(){return!(null!=this.value()&&""!==this.value())}},{key:"is_selected",value:function(){var e;return e=this.picker.select.val(),this.picker.multiple?jQuery.inArray(this.value(),e)>=0:this.value()===e}},{key:"mark_as_selected",value:function(){return this.node.find(".thumbnail").addClass("selected")}},{key:"unmark_as_selected",value:function(){return this.node.find(".thumbnail").removeClass("selected")}},{key:"value",value:function(){return this.option.val()}},{key:"label",value:function(){return this.option.data("img-label")?this.option.data("img-label"):this.option.text()}},{key:"clicked",value:function(e){if(this.picker.toggle(this,e),null!=this.opts.clicked&&this.opts.clicked.call(this.picker.select,this,e),null!=this.opts.selected&&this.is_selected())return this.opts.selected.call(this.picker.select,this,e)}},{key:"create_node",value:function(){var e,t,i,s;return this.node=jQuery("<li/>"),this.option.data("font_awesome")?(e=jQuery("<i>")).attr("class","fa-fw "+this.option.data("img-src")):(e=jQuery("<img class='image_picker_image'/>")).attr("src",this.option.data("img-src")),s=jQuery("<div class='thumbnail'>"),(i=this.option.data("img-class"))&&(this.node.addClass(i),e.addClass(i),s.addClass(i)),(t=this.option.data("img-alt"))&&e.attr("alt",t),s.on("click",this.clicked),s.append(e),this.opts.show_label&&s.append(jQuery("<p/>").html(this.label())),this.node.append(s),this.node}}]),e}()}).call(void 0),jQuery(document).ready((function(e){function t(e,t){var i=e.find("[data-piotnetforms-image-select]");i.length&&t.each(i,(function(e,i){var s=t(i).closest("[data-elementor-type]").attr("data-elementor-type"),l=t(i).data("piotnetforms-image-select"),a=t(i).find("option"),n={show_label:!0};null!=t(i).attr("data-piotnetforms-image-select-limit-multiple")&&(n.limit=t(i).attr("data-piotnetforms-image-select-limit-multiple")),t(i).closest(".piotnetforms-field").addClass("piotnetforms-image-select-field"),"popup"!=s&&a.each((function(e,s){if(""==a.eq(0).attr("value").trim()&&0!=e){var r=l[e-1].url;t(this).attr("data-img-src",r),t(i).imagepicker(n)}""!=a.eq(0).attr("value").trim()&&null!=l[e]&&(r=l[e].url,t(this).attr("data-img-src",r),t(i).imagepicker(n)),t(i).closest(".piotnetforms-image-select-field").find(".thumbnail.selected").closest("li").addClass("disabled")}))}))}e(document).on("piotnet-widget-init-Piotnetforms_Field","[data-piotnet-editor-widgets-item-root]",(function(){t(e(this),e)})),t(e("[data-piotnet-widget-preview], #piotnetforms"),e),e(document).on("elementor/popup/show",(function(){!function(e,t){var i=e.find("[data-piotnetforms-image-select]");i.length&&t.each(i,(function(e,i){var s=t(i).data("piotnetforms-image-select"),l=t(i).find("option"),a={show_label:!0};null!=t(i).attr("data-piotnetforms-image-select-limit-multiple")&&(a.limit=t(i).attr("data-piotnetforms-image-select-limit-multiple")),t(i).closest(".piotnetforms-field").addClass("piotnetforms-image-select-field"),l.each((function(e,n){if(""==l.eq(0).attr("value").trim()&&0!=e){var r=s[e-1].url;t(this).attr("data-img-src",r),t(i).imagepicker(a)}""!=l.eq(0).attr("value").trim()&&null!=s[e]&&(r=s[e].url,t(this).attr("data-img-src",r),t(i).imagepicker(a)),t(i).closest(".piotnetforms-image-select-field").find(".thumbnail.selected").closest("li").addClass("disabled")}))}))}(e(this),e)}))}));