jQuery(document).ready((function(t){function a(){this.length=8,this.timestamp=+new Date,this.generate=function(){for(var t,a,e=this.timestamp.toString().split("").reverse(),o="",n=0;n<this.length;++n)o+=e[(t=0,a=e.length-1,Math.floor(Math.random()*(a-t+1))+t)];return o}}t(document).on("keyup change","[data-piotnetforms-id]",(function(){var e=t(this).attr("data-piotnetforms-id");if(t('[data-piotnetforms-abandonment] [data-piotnetforms-submit-form-id="'+e+'"]').length>0){var o,n=t(this).val(),r=t(this).attr("name").replace("form_fields[","").replace("]","").replace("[]",""),i="piotnetforms-abandonment-"+e;"checkbox"==t(this).attr("type")&&(t(this).attr("name").includes("[]")?(n=[],t(this).closest("form").find('[name="form_fields['+r+'][]"]').each((function(){t(this).is(":checked")&&n.push(t(this).val())}))):t(this).is(":checked")||(n="")),localStorage[i]?(o=JSON.parse(localStorage.getItem(i)))[r]=n:(o={userId:(new a).generate(),form_id:e})[r]=n,localStorage.setItem(i,JSON.stringify(o))}})),t("[data-piotnetforms-abandonment] [data-piotnetforms-submit-form-id]").each((function(){var a="piotnetforms-abandonment-"+t(this).attr("data-piotnetforms-submit-form-id"),e=t('[data-piotnetforms-id][name^="form_fields"]');if(localStorage[a]){var o=JSON.parse(localStorage.getItem(a));e.each((function(){var a=t(this).attr("type"),e=t(this).attr("name").replace("form_fields[","").replace("]","").replace("[]","");"radio"==a?void 0!==o[e]&&t(this).attr("value")==o[e]&&t(this).prop("checked",!0):"checkbox"==a?void 0!==o[e]&&(t(this).attr("name").includes("[]")?o[e].includes(t(this).attr("value"))&&t(this).prop("checked",!0):t(this).attr("value")==o[e]&&t(this).prop("checked",!0)):void 0!==o[e]&&t(this).val(o[e])}))}})),t(document).on("click","[data-piotnetforms-trigger-success]",(function(){var a="piotnetforms-abandonment-"+t(this).attr("data-piotnetforms-trigger-success"),e=t("[data-piotnetforms-abandonment-webhook]"),o=e.length>0&&e.attr("data-piotnetforms-abandonment-webhook");if(localStorage[a]){var n=JSON.parse(localStorage.getItem(a)),r=new FormData;r.append("action","piotnetforms_form_abandonment"),r.append("fields",JSON.stringify(n)),r.append("form_type","piotnetforms Form"),r.append("function","success"),r.append("webhook",o),navigator.sendBeacon(t("[data-piotnetforms-ajax-url]").data("piotnetforms-ajax-url"),r),localStorage.removeItem(a)}})),t(window).on("blur beforeunload",(function(a){var e;e=a.type,t("[data-piotnetforms-abandonment] [data-piotnetforms-submit-form-id]").each((function(){var a="piotnetforms-abandonment-"+t(this).attr("data-piotnetforms-submit-form-id"),o=t("[data-piotnetforms-abandonment-webhook]"),n=o.length>0&&o.attr("data-piotnetforms-abandonment-webhook");if("blur"==e&&(n=!1),localStorage[a]){var r=JSON.parse(localStorage.getItem(a)),i=new FormData;i.append("action","piotnetforms_form_abandonment"),i.append("fields",JSON.stringify(r)),i.append("form_type","piotnetforms"),i.append("function","abandonment"),i.append("webhook",n),navigator.sendBeacon(t("[data-piotnetforms-ajax-url]").data("piotnetforms-ajax-url"),i)}}))}))}));